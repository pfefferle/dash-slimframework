<!DOCTYPE html>
<html lang="en">
    
<!-- Mirrored from www.slimframework.com/docs/v3/cookbook/database-doctrine.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 29 Nov 2019 20:20:20 GMT -->
<!-- Added by HTTrack --><meta http-equiv="content-type" content="text/html;charset=utf-8" /><!-- /Added by HTTrack -->
<head>
        <meta charset="utf-8"/>
        <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1"/>
        <meta http-equiv="X-UA-Compatible" content="IE=edge,chrome=1"/>
        <title>Using Doctrine with Slim - Slim Framework</title>
        <meta name="description" content=""/>
        <meta name="robots" content="index, follow"/>
        <meta property="og:title" content="Using Doctrine with Slim"/>
        <meta property="og:site_name" content="Slim Framework"/>
        <meta property="og:url" content="database-doctrine.html"/>
        <meta property="og:description" content=""/>
        <meta property="og:type" content="website"/>
        <!--[if lt IE 9]><script src="http://html5shiv.googlecode.com/svn/trunk/html5.js"></script><![endif]-->
        <link rel="stylesheet" href="../../../assets/css/all.css"/>
        <link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.css" />
        <link rel="shortcut icon" href="../../../assets/images/favicon.png"/>
        <link rel="stylesheet" href="../../../../maxcdn.bootstrapcdn.com/font-awesome/4.7.0/css/font-awesome.min.css"/>
        <link href="https://fonts.googleapis.com/css?family=Lato:400,700" rel="stylesheet">
        <script src="https://use.typekit.net/yjz4fyo.js"></script>
        <script>try{Typekit.load();}catch(e){}</script>
        <script>
            var _gaq = _gaq || [];
            _gaq.push(['_setAccount', 'UA-19430723-1']);
            _gaq.push(['_trackPageview']);
            (function() {
                var ga = document.createElement('script'); ga.type = 'text/javascript'; ga.async = true;
                ga.src = ('https:' == document.location.protocol ? 'https://ssl' : 'http://www') + '.google-analytics.com/ga.js';
                var s = document.getElementsByTagName('script')[0]; s.parentNode.insertBefore(ga, s);
            })();
        </script>
    </head>
    <body>
        <nav class="navbar navbar-default navbar-fixed-top">
            <div class="container-fluid">
                <!-- Brand and toggle get grouped for better mobile display -->
                <div class="navbar-header">
                    <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#bs-example-navbar-collapse-1" aria-expanded="false">
                        <span class="sr-only">Toggle navigation</span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                        <span class="icon-bar"></span>
                    </button>
                    <a class="navbar-logo" href="http://www.slimframework.com/">Slim</a>
                </div>

                <!-- Collect the nav links, forms, and other content for toggling -->
                <div class="collapse navbar-collapse" id="bs-example-navbar-collapse-1">
                    <ul class="nav navbar-nav">
                        <li><a href="http://www.slimframework.com/blog">Blog</a></li>
                        <li class="active"><a href="../../v4/index.html">User Guide</a></li>
                        <li><a href="http://discourse.slimframework.com/">Support</a></li>
                        <li><a href="http://www.slimframework.com/contribute">Contribute</a></li>
                    </ul>
                    
                        
                        
                            
                        
                            
                                <div class="navbar-documentation-version-badge">
                                    <span>v3 Documentation</span>
                                </div>
                        
                        
                            
                        
                    
                </div>
            </div>
        </nav>

<div class="wrapper docs">
    <div class="container-fluid">
        <div class="row">
            <div class="col-md-3">
                <div class="toc-nav-toggle">
                    <button class="btn btn-primary" type="button" data-toggle="collapse" data-target="#tocNav"
                            aria-expanded="false" aria-controls="tocNav">
                        Toggle Navigation
                    </button>
                </div>
                <div class="collapse toc-nav-collapse" id="tocNav">
                    <h3 class="toc-title" style="margin-top:0">Slim Version</h3>
<div style="border:1px solid #CCC;border-radius:16px;box-sizing:border-box;margin:0 0 30px;padding:0 8px;width:200px;-webkit-appearance:none">
    <select onchange="this.options[this.selectedIndex].value && (window.location = this.options[this.selectedIndex].value);" style="border:0;border-radius:16px;height:32px;margin:0;outline:none;padding:0;width:100%">
        
        
            
            
            <option value="/docs/v2">v2</option>
        
            
            
            <option value="/docs/v3" selected>v3</option>
        
            
            
            <option value="/docs/v4">v4</option>
        
    </select>
</div>

                    <h3 class="toc-title">Search</h3>
<div class="svg-icons" style="height: 0; width: 0; position: absolute; visibility: hidden">
    <svg xmlns="http://www.w3.org/2000/svg">
        <symbol id="sbx-icon-clear-3" viewBox="0 0 40 40"><path d="M16.228 20L1.886 5.657 0 3.772 3.772 0l1.885 1.886L20 16.228 34.343 1.886 36.228 0 40 3.772l-1.886 1.885L23.772 20l14.342 14.343L40 36.228 36.228 40l-1.885-1.886L20 23.772 5.657 38.114 3.772 40 0 36.228l1.886-1.885L16.228 20z" fill-rule="evenodd"/></symbol>
        <symbol id="sbx-icon-search-13" viewBox="0 0 40 40"><path d="M26.806 29.012a16.312 16.312 0 0 1-10.427 3.746C7.332 32.758 0 25.425 0 16.378 0 7.334 7.333 0 16.38 0c9.045 0 16.378 7.333 16.378 16.38 0 3.96-1.406 7.593-3.746 10.426L39.547 37.34c.607.608.61 1.59-.004 2.203a1.56 1.56 0 0 1-2.202.004L26.807 29.012zm-10.427.627c7.322 0 13.26-5.938 13.26-13.26 0-7.324-5.938-13.26-13.26-13.26-7.324 0-13.26 5.936-13.26 13.26 0 7.322 5.936 13.26 13.26 13.26z" fill-rule="evenodd"/></symbol>
    </svg>
</div>
<form novalidate="novalidate" onsubmit="return false;" class="searchbox" style="visibility:hidden;height:0;margin-bottom:30px">
    <div role="search" class="searchbox__wrapper">
        <input id="docsearch" type="search" name="search" placeholder="Search in the doc" autocomplete="off" required="required" class="searchbox__input">
        <button type="submit" title="Submit your search query." class="searchbox__submit" >
            <svg role="img" aria-label="Search">
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#sbx-icon-search-13"></use>
            </svg>
        </button>
        <button type="reset" title="Clear the search query." class="searchbox__reset hide">
            <svg role="img" aria-label="Reset">
                <use xmlns:xlink="http://www.w3.org/1999/xlink" xlink:href="#sbx-icon-clear-3"></use>
            </svg>
        </button>
    </div>
</form>
                    
                        
                        
                        <h3 class="toc-title">Get Started</h3>
                        <ul class="toc-links">
                            
                                
                                <li><a href="../index.html">Home</a></li>
                            
                                
                                <li><a href="../start/installation.html">Installation</a></li>
                            
                                
                                <li><a href="../start/upgrade.html">Upgrade Guide</a></li>
                            
                                
                                <li><a href="../start/web-servers.html">Web Servers</a></li>
                            
                                
                                <li><a href="../deployment/deployment.html">Deployment</a></li>
                            
                        </ul>
                    
                        
                        
                        <h3 class="toc-title">Tutorial</h3>
                        <ul class="toc-links">
                            
                                
                                <li><a href="../tutorial/first-app.html">First Application</a></li>
                            
                        </ul>
                    
                        
                        
                        <h3 class="toc-title">Concepts</h3>
                        <ul class="toc-links">
                            
                                
                                <li><a href="../concepts/life-cycle.html">Application Life Cycle</a></li>
                            
                                
                                <li><a href="../concepts/value-objects.html">PSR-7</a></li>
                            
                                
                                <li><a href="../concepts/middleware.html">Middleware</a></li>
                            
                                
                                <li><a href="../concepts/di.html">Dependency Container</a></li>
                            
                        </ul>
                    
                        
                        
                        <h3 class="toc-title">The Application</h3>
                        <ul class="toc-links">
                            
                                
                                <li><a href="../objects/application.html">Overview</a></li>
                            
                                
                                <li><a href="../objects/application.html#application-configuration">Configuration</a></li>
                            
                                
                                <li><a href="../objects/application.html#slim-default-settings">Default settings</a></li>
                            
                        </ul>
                    
                        
                        
                        <h3 class="toc-title">The Request</h3>
                        <ul class="toc-links">
                            
                                
                                <li><a href="../objects/request.html">Overview</a></li>
                            
                                
                                <li><a href="../objects/request.html#the-request-method">Method</a></li>
                            
                                
                                <li><a href="../objects/request.html#the-request-headers">Headers</a></li>
                            
                                
                                <li><a href="../objects/request.html#the-request-body">Body</a></li>
                            
                                
                                <li><a href="../objects/request.html#uploaded-files">Uploaded Files</a></li>
                            
                                
                                <li><a href="../objects/request.html#request-helpers">Helpers</a></li>
                            
                                
                                <li><a href="../objects/request.html#route-object">Route object</a></li>
                            
                                
                                <li><a href="../objects/request.html#media-type-parsers">Media type parsers</a></li>
                            
                        </ul>
                    
                        
                        
                        <h3 class="toc-title">The Response</h3>
                        <ul class="toc-links">
                            
                                
                                <li><a href="../objects/response.html">Overview</a></li>
                            
                                
                                <li><a href="../objects/response.html#the-response-status">Status</a></li>
                            
                                
                                <li><a href="../objects/response.html#the-response-headers">Headers</a></li>
                            
                                
                                <li><a href="../objects/response.html#the-response-body">Body</a></li>
                            
                                
                                <li><a href="../objects/response.html#returning-json">JSON</a></li>
                            
                        </ul>
                    
                        
                        
                        <h3 class="toc-title">Routing</h3>
                        <ul class="toc-links">
                            
                                
                                <li><a href="../objects/router.html">Overview</a></li>
                            
                                
                                <li><a href="../objects/router.html#how-to-create-routes">Create Routes</a></li>
                            
                                
                                <li><a href="../objects/router.html#route-callbacks">Callbacks</a></li>
                            
                                
                                <li><a href="../objects/router.html#route-strategies">Strategies</a></li>
                            
                                
                                <li><a href="../objects/router.html#route-placeholders">Placeholders</a></li>
                            
                                
                                <li><a href="../objects/router.html#route-names">Names</a></li>
                            
                                
                                <li><a href="../objects/router.html#route-groups">Groups</a></li>
                            
                                
                                <li><a href="../objects/router.html#route-middleware">Middleware</a></li>
                            
                                
                                <li><a href="../objects/router.html#container-resolution">Container Resolution</a></li>
                            
                        </ul>
                    
                        
                        
                        <h3 class="toc-title">Error Handling</h3>
                        <ul class="toc-links">
                            
                                
                                <li><a href="../handlers/error.html">Error Handlers</a></li>
                            
                                
                                <li><a href="../handlers/not-found.html">404 Not Found</a></li>
                            
                                
                                <li><a href="../handlers/not-allowed.html">405 Not Allowed</a></li>
                            
                                
                                <li><a href="../handlers/php-error.html">PHP Runtime Error</a></li>
                            
                        </ul>
                    
                        
                        
                        <h3 class="toc-title active">Cook book</h3>
                        <ul class="toc-links">
                            
                                
                                <li><a href="route-patterns.html">Trailing / in routes</a></li>
                            
                                
                                <li><a href="ip-address.html">Retrieving IP address</a></li>
                            
                                
                                <li><a href="retrieving-current-route.html">Retrieving Current Route</a></li>
                            
                                
                                <li><a href="database-eloquent.html">Using Eloquent with Slim</a></li>
                            
                                
                                <li><a href="database-doctrine.html">Using Doctrine with Slim</a></li>
                            
                                
                                <li><a href="database-atlas.html">Using Atlas with Slim</a></li>
                            
                                
                                <li><a href="enable-cors.html">Enabling CORS</a></li>
                            
                                
                                <li><a href="environment.html">Getting and Mocking the Environment</a></li>
                            
                                
                                <li><a href="uploading-files.html">Uploading Files using POST forms</a></li>
                            
                                
                                <li><a href="action-domain-responder.html">Action-Domain-Responder with Slim</a></li>
                            
                        </ul>
                    
                        
                        
                        <h3 class="toc-title">Add Ons</h3>
                        <ul class="toc-links">
                            
                                
                                <li><a href="../features/templates.html">Templates</a></li>
                            
                                
                                <li><a href="../features/caching.html">HTTP Caching</a></li>
                            
                                
                                <li><a href="../features/csrf.html">CSRF Protection</a></li>
                            
                                
                                <li><a href="../features/flash.html">Flash Messages</a></li>
                            
                                
                                <li><a href="https://github.com/slimphp/Slim/wiki/Middleware-for-Slim-Framework-v3.x/">3rd Party</a></li>
                            
                        </ul>
                    
                        
                        
                        <h3 class="toc-title">Contributing</h3>
                        <ul class="toc-links">
                            
                                
                                <li><a href="../contributors/strategy.html">Branching Strategy</a></li>
                            
                                
                                <li><a href="../contributors/guidelines.html">Guidelines</a></li>
                            
                        </ul>
                    
                </div>
            </div>

            <div class="col-md-8 docs-content">
                <h1 class="page-header">Using Doctrine with Slim</h1>
                <div class="edit-panel" style="margin: 0 0 1em 0;">
                    <a href="https://github.com/slimphp/Slim-Website/tree/gh-pages/docs/v3/cookbook/database-doctrine.md" target="_blank" class="btn btn-default btn-sm"><i class="fa fa-github"></i> Edit This Page</a>
                </div>
                <p>This cookbook entry describes how to integrate from scratch the widely used <a href="http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/">Doctrine ORM</a> into a Slim application.</p>

<h2 id="adding-doctrine-to-your-application">Adding Doctrine to your application</h2>

<p>The first step is importing the library into the <code class="language-plaintext highlighter-rouge">vendor</code> directory of your project using <a href="https://getcomposer.org/">composer</a>.</p>

<figure>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code>composer require doctrine/orm:^2
</code></pre></div>  </div>
  <figcaption>Figure 1: Require doctrine in your application.</figcaption>
</figure>

<h2 id="provide-database-credentials">Provide database credentials</h2>

<p>Next, add the Doctrine settings alongside your Slim configuration.</p>

<figure>
  <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="c1">// settings.php</span>

<span class="nb">define</span><span class="p">(</span><span class="s1">'APP_ROOT'</span><span class="p">,</span> <span class="nx">__DIR__</span><span class="p">);</span>

<span class="k">return</span> <span class="p">[</span>
    <span class="s1">'settings'</span> <span class="o">=&gt;</span> <span class="p">[</span>
        <span class="s1">'displayErrorDetails'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>
        <span class="s1">'determineRouteBeforeAppMiddleware'</span> <span class="o">=&gt;</span> <span class="kc">false</span><span class="p">,</span>

        <span class="s1">'doctrine'</span> <span class="o">=&gt;</span> <span class="p">[</span>
            <span class="c1">// if true, metadata caching is forcefully disabled</span>
            <span class="s1">'dev_mode'</span> <span class="o">=&gt;</span> <span class="kc">true</span><span class="p">,</span>

            <span class="c1">// path where the compiled metadata info will be cached</span>
            <span class="c1">// make sure the path exists and it is writable</span>
            <span class="s1">'cache_dir'</span> <span class="o">=&gt;</span> <span class="nx">APP_ROOT</span> <span class="o">.</span> <span class="s1">'/var/doctrine'</span><span class="p">,</span>

            <span class="c1">// you should add any other path containing annotated entity classes</span>
            <span class="s1">'metadata_dirs'</span> <span class="o">=&gt;</span> <span class="p">[</span><span class="nx">APP_ROOT</span> <span class="o">.</span> <span class="s1">'/src/Domain'</span><span class="p">],</span>

            <span class="s1">'connection'</span> <span class="o">=&gt;</span> <span class="p">[</span>
                <span class="s1">'driver'</span> <span class="o">=&gt;</span> <span class="s1">'pdo_mysql'</span><span class="p">,</span>
                <span class="s1">'host'</span> <span class="o">=&gt;</span> <span class="s1">'localhost'</span><span class="p">,</span>
                <span class="s1">'port'</span> <span class="o">=&gt;</span> <span class="mi">3306</span><span class="p">,</span>
                <span class="s1">'dbname'</span> <span class="o">=&gt;</span> <span class="s1">'mydb'</span><span class="p">,</span>
                <span class="s1">'user'</span> <span class="o">=&gt;</span> <span class="s1">'user'</span><span class="p">,</span>
                <span class="s1">'password'</span> <span class="o">=&gt;</span> <span class="s1">'secret'</span><span class="p">,</span>
                <span class="s1">'charset'</span> <span class="o">=&gt;</span> <span class="s1">'utf-8'</span>
            <span class="p">]</span>
        <span class="p">]</span>
    <span class="p">]</span>
<span class="p">];</span>
</code></pre></div>  </div>
  <figcaption>Figure 2: Slim settings array.</figcaption>
</figure>

<h2 id="define-the-entitymanager-service">Define the EntityManager service</h2>

<p>Now we define the <code class="language-plaintext highlighter-rouge">EntityManager</code> service, which is the primary way to interact with Doctrine.
Here we show how to configure the metadata reader to work with PHP annotations, which is at the
same time the most used mode and the most tricky to set up. Alternatively, XML or YAML can also
be used to describe the database schema.</p>

<figure>
  <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="c1">// bootstrap.php</span>

<span class="kn">use</span> <span class="nn">Doctrine\Common\Annotations\AnnotationReader</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Doctrine\Common\Cache\FilesystemCache</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Doctrine\ORM\EntityManager</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Doctrine\ORM\Mapping\Driver\AnnotationDriver</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Doctrine\ORM\Tools\Setup</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Slim\Container</span><span class="p">;</span>

<span class="k">require_once</span> <span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">'/vendor/autoload.php'</span><span class="p">;</span>

<span class="nv">$container</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">Container</span><span class="p">(</span><span class="k">require</span> <span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">'/settings.php'</span><span class="p">);</span>

<span class="nv">$container</span><span class="p">[</span><span class="nx">EntityManager</span><span class="o">::</span><span class="na">class</span><span class="p">]</span> <span class="o">=</span> <span class="k">function</span> <span class="p">(</span><span class="nx">Container</span> <span class="nv">$container</span><span class="p">)</span><span class="o">:</span> <span class="nx">EntityManager</span> <span class="p">{</span>
    <span class="nv">$config</span> <span class="o">=</span> <span class="nx">Setup</span><span class="o">::</span><span class="na">createAnnotationMetadataConfiguration</span><span class="p">(</span>
        <span class="nv">$container</span><span class="p">[</span><span class="s1">'settings'</span><span class="p">][</span><span class="s1">'doctrine'</span><span class="p">][</span><span class="s1">'metadata_dirs'</span><span class="p">],</span>
        <span class="nv">$container</span><span class="p">[</span><span class="s1">'settings'</span><span class="p">][</span><span class="s1">'doctrine'</span><span class="p">][</span><span class="s1">'dev_mode'</span><span class="p">]</span>
    <span class="p">);</span>

    <span class="nv">$config</span><span class="o">-&gt;</span><span class="na">setMetadataDriverImpl</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">AnnotationDriver</span><span class="p">(</span>
            <span class="k">new</span> <span class="nx">AnnotationReader</span><span class="p">,</span>
            <span class="nv">$container</span><span class="p">[</span><span class="s1">'settings'</span><span class="p">][</span><span class="s1">'doctrine'</span><span class="p">][</span><span class="s1">'metadata_dirs'</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">);</span>

    <span class="nv">$config</span><span class="o">-&gt;</span><span class="na">setMetadataCacheImpl</span><span class="p">(</span>
        <span class="k">new</span> <span class="nx">FilesystemCache</span><span class="p">(</span>
            <span class="nv">$container</span><span class="p">[</span><span class="s1">'settings'</span><span class="p">][</span><span class="s1">'doctrine'</span><span class="p">][</span><span class="s1">'cache_dir'</span><span class="p">]</span>
        <span class="p">)</span>
    <span class="p">);</span>

    <span class="k">return</span> <span class="nx">EntityManager</span><span class="o">::</span><span class="na">create</span><span class="p">(</span>
        <span class="nv">$container</span><span class="p">[</span><span class="s1">'settings'</span><span class="p">][</span><span class="s1">'doctrine'</span><span class="p">][</span><span class="s1">'connection'</span><span class="p">],</span>
        <span class="nv">$config</span>
    <span class="p">);</span>
<span class="p">};</span>

<span class="k">return</span> <span class="nv">$container</span><span class="p">;</span>
</code></pre></div>  </div>
  <figcaption>Figure 3: Defining the EntityManager service.</figcaption>
</figure>

<h2 id="create-the-doctrine-console">Create the Doctrine console</h2>

<p>To run database migrations, validate class annotations and so on you will use the <code class="language-plaintext highlighter-rouge">doctrine</code> CLI application that is
already present at <code class="language-plaintext highlighter-rouge">vendor/bin</code>. But in order to work, this script needs a <a href="http://docs.doctrine-project.org/en/latest/reference/configuration.html#setting-up-the-commandline-tool"><code class="language-plaintext highlighter-rouge">cli-config.php</code></a>
file at the root of the project telling it how to find the <code class="language-plaintext highlighter-rouge">EntityManager</code> we just set up:</p>

<figure>

  <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="cp">&lt;?php</span>

<span class="c1">// cli-config.php</span>

<span class="kn">use</span> <span class="nn">Doctrine\ORM\EntityManager</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Doctrine\ORM\Tools\Console\ConsoleRunner</span><span class="p">;</span>
<span class="kn">use</span> <span class="nn">Slim\Container</span><span class="p">;</span>

<span class="cd">/** @var Container $container */</span>
<span class="nv">$container</span> <span class="o">=</span> <span class="k">require_once</span> <span class="nx">__DIR__</span> <span class="o">.</span> <span class="s1">'/bootstrap.php'</span><span class="p">;</span>

<span class="k">return</span> <span class="nx">ConsoleRunner</span><span class="o">::</span><span class="na">createHelperSet</span><span class="p">(</span><span class="nv">$container</span><span class="p">[</span><span class="nx">EntityManager</span><span class="o">::</span><span class="na">class</span><span class="p">])</span>
</code></pre></div>  </div>

  <figcaption>Figure 4: Enabling Doctrine's console app.</figcaption>
</figure>

<p>Take a moment to verify that the console app works. When properly configured, its output will look more or less like this:</p>

<figure>
  <div class="language-bash highlighter-rouge"><div class="highlight"><pre class="highlight"><code><span class="nv">$ </span>php vendor/bin/doctrine
Doctrine Command Line Interface 2.5.12

Usage:
  <span class="nb">command</span> <span class="o">[</span>options] <span class="o">[</span>arguments]

Options:
  <span class="nt">-h</span>, <span class="nt">--help</span>            Display this <span class="nb">help </span>message
  <span class="nt">-q</span>, <span class="nt">--quiet</span>           Do not output any message
  <span class="nt">-V</span>, <span class="nt">--version</span>         Display this application version
      <span class="nt">--ansi</span>            Force ANSI output
      <span class="nt">--no-ansi</span>         Disable ANSI output
  <span class="nt">-n</span>, <span class="nt">--no-interaction</span>  Do not ask any interactive question
  <span class="nt">-v</span>|vv|vvv, <span class="nt">--verbose</span>  Increase the verbosity of messages: 1 <span class="k">for </span>normal output, 2 <span class="k">for </span>more verbose output and 3 <span class="k">for </span>debug

Available commands:
  <span class="nb">help                            </span>Displays <span class="nb">help </span><span class="k">for </span>a <span class="nb">command
  </span>list                            Lists commands
 dbal
  dbal:import                     Import SQL file<span class="o">(</span>s<span class="o">)</span> directly to Database.
  dbal:run-sql                    Executes arbitrary SQL directly from the <span class="nb">command </span>line.
 orm
  orm:clear-cache:metadata        Clear all metadata cache of the various cache drivers.
  orm:clear-cache:query           Clear all query cache of the various cache drivers.
  orm:clear-cache:result          Clear all result cache of the various cache drivers.
  orm:convert-d1-schema           <span class="o">[</span>orm:convert:d1-schema] Converts Doctrine 1.X schema into a Doctrine 2.X schema.
  orm:convert-mapping             <span class="o">[</span>orm:convert:mapping] Convert mapping information between supported formats.
  orm:ensure-production-settings  Verify that Doctrine is properly configured <span class="k">for </span>a production environment.
  orm:generate-entities           <span class="o">[</span>orm:generate:entities] Generate entity classes and method stubs from your mapping information.
  orm:generate-proxies            <span class="o">[</span>orm:generate:proxies] Generates proxy classes <span class="k">for </span>entity classes.
  orm:generate-repositories       <span class="o">[</span>orm:generate:repositories] Generate repository classes from your mapping information.
  orm:info                        Show basic information about all mapped entities
  orm:mapping:describe            Display information about mapped objects
  orm:run-dql                     Executes arbitrary DQL directly from the <span class="nb">command </span>line.
  orm:schema-tool:create          Processes the schema and either create it directly on EntityManager Storage Connection or generate the SQL output.
  orm:schema-tool:drop            Drop the <span class="nb">complete </span>database schema of EntityManager Storage Connection or generate the corresponding SQL output.
  orm:schema-tool:update          Executes <span class="o">(</span>or dumps<span class="o">)</span> the SQL needed to update the database schema to match the current mapping metadata.
  orm:validate-schema             Validate the mapping files.
</code></pre></div>  </div>
  <figcaption>Figure 5: Test-driving Docrine's console application.</figcaption>
</figure>

<p>If it works, you can now create your database and load the schema by running <code class="language-plaintext highlighter-rouge">php vendor/bin/doctrine orm:schema-tool:update</code></p>

<h2 id="using-the-entitymanager-in-our-own-code">Using the EntityManager in our own code</h2>

<p>Congratulations! Now you can already manage your database from the command line, and use the <code class="language-plaintext highlighter-rouge">EntityManager</code> wherever you need it.</p>

<figure>
  <div class="language-php highlighter-rouge"><div class="highlight"><pre class="highlight"><code>
<span class="nv">$container</span><span class="p">[</span><span class="nx">UserRepository</span><span class="o">::</span><span class="na">class</span><span class="p">]</span> <span class="o">=</span> <span class="k">function</span> <span class="p">(</span><span class="nv">$container</span><span class="p">)</span> <span class="p">{</span>
    <span class="k">return</span> <span class="k">new</span> <span class="nx">UserRepository</span><span class="p">(</span><span class="nv">$container</span><span class="p">[</span><span class="nx">EntityManager</span><span class="o">::</span><span class="na">class</span><span class="p">]);</span>
<span class="p">};</span>

<span class="c1">// src/UserRepository.php</span>

<span class="kd">class</span> <span class="nc">UserRepository</span>
<span class="p">{</span>
    <span class="cd">/**
     * @var EntityManager
     */</span>
    <span class="k">private</span> <span class="nv">$em</span><span class="p">;</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">__construct</span><span class="p">(</span><span class="nx">EntityManager</span> <span class="nv">$em</span><span class="p">)</span>
    <span class="p">{</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">em</span> <span class="o">=</span> <span class="nv">$em</span><span class="p">;</span>
    <span class="p">}</span>

    <span class="k">public</span> <span class="k">function</span> <span class="nf">signUp</span><span class="p">(</span><span class="nx">string</span> <span class="nv">$email</span><span class="p">,</span> <span class="nx">string</span> <span class="nv">$password</span><span class="p">)</span><span class="o">:</span> <span class="nx">User</span>
    <span class="p">{</span>
        <span class="nv">$user</span> <span class="o">=</span> <span class="k">new</span> <span class="nx">User</span><span class="p">(</span><span class="nv">$email</span><span class="p">,</span> <span class="nv">$password</span><span class="p">);</span>

        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">em</span><span class="o">-&gt;</span><span class="na">persist</span><span class="p">(</span><span class="nv">$user</span><span class="p">);</span>
        <span class="nv">$this</span><span class="o">-&gt;</span><span class="na">em</span><span class="o">-&gt;</span><span class="na">flush</span><span class="p">();</span>

        <span class="k">return</span> <span class="nv">$user</span><span class="p">;</span>
    <span class="p">}</span>
<span class="p">}</span>
</code></pre></div>  </div>
  <figcaption>Figure 6: Using the EntityManager service.</figcaption>
</figure>

<h2 id="other-resources">Other resources</h2>

<ul>
  <li>The <a href="http://docs.doctrine-project.org/projects/doctrine-orm/en/latest/">official Doctrine ORM documentation</a>.</li>
  <li><a href="https://github.com/1ma/Slim-Doctrine-Demo">A full example</a> of the above configuration in a small, functioning project.</li>
</ul>


                <nav>
                    <ul class="nav pager">
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                
                                  
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                
                                    
                                        <li class="previous">
                                            <a href="database-eloquent.html" rel="prev"><i class="fa fa-arrow-left"></i> <small>Cook book: </small> Using Eloquent with Slim</a>
                                        </li>
                                    
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                
                                    <li class="next">
                                        <a href="database-atlas.html" rel="next"><small>Cook book: </small> Using Atlas with Slim <i class="fa fa-arrow-right"></i></a>
                                    </li>
                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                            
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            

                                
                                

                                
                                

                                

                                
                                
                                
                            
                        
                    </ul>
                </nav>
            </div>
        </div>
        <footer class="site-footer">
    <p>
        Created and maintained by <br/>
        <a href="http://joshlockhart.com/">Josh Lockhart</a>,
        <a href="http://www.silentworks.co.uk/" target="_blank">Andrew Smith</a>,
        <a href="http://akrabat.com/" target="_blank">Rob Allen</a>,
        <a href="http://www.lgse.com/" target="_blank">Pierre Bérubé</a>, and the
        <a href="https://github.com/orgs/slimphp/people" target="_blank">Slim Framework Team</a>
    </p>
    <form action="https://www.paypal.com/cgi-bin/webscr" method="post" target="_blank" style="margin: 0; padding-top: 20px">
        <input type="hidden" name="cmd" value="_s-xclick">
        <input type="hidden" name="hosted_button_id" value="9YRVXHRZT6H3L">
        <input type="image" src="https://www.paypalobjects.com/en_US/i/btn/btn_donateCC_LG.gif" border="0" name="submit" alt="PayPal - The safer, easier way to pay online!">
        <img alt="" border="0" src="https://www.paypalobjects.com/en_US/i/scr/pixel.gif" width="1" height="1">
    </form>
</footer>

    </div>
</div>
        <script src="https://ajax.googleapis.com/ajax/libs/jquery/1.11.3/jquery.min.js"></script>
        <script src="https://maxcdn.bootstrapcdn.com/bootstrap/3.3.5/js/bootstrap.min.js"></script>
        <script src="../../../assets/scripts/build/production.min.js"></script>
        
        <script src="https://cdn.jsdelivr.net/npm/docsearch.js@2/dist/cdn/docsearch.min.js"></script>
        <script>
          docsearch({
            apiKey: '8ed5262aecf5240c6d66dbba260f3e51',
            appId: 'KS0N5YSBFY',
            indexName: 'slim-docs',
            inputSelector: '#docsearch',
            debug: true,
            transformData: function (suggestions) {
              for (var i = 0; i < suggestions.length; i++) {
                var suggestion = suggestions[i];

                var docVersion = null;
                var urlFragments = suggestion.url.split("http://www.slimframework.com/");
                if (urlFragments.length >= 3 && urlFragments[1] === "docs") {
                  docVersion = urlFragments[2];
                }

                if (suggestion.hierarchy.lvl0 === null) {
                  suggestions[i].hierarchy.lvl0 = docVersion ? "Slim " + docVersion + " - " + suggestion.title : suggestion.title
                }
              }
              return suggestions;
            },
          });
        </script>
        
        <script>!function(d,s,id){var js,fjs=d.getElementsByTagName(s)[0],p=/^http:/.test(d.location)?'http':'https';if(!d.getElementById(id)){js=d.createElement(s);js.id=id;js.src=p+"://platform.twitter.com/widgets.js";fjs.parentNode.insertBefore(js,fjs);}}(document,"script","twitter-wjs");</script>
    </body>

<!-- Mirrored from www.slimframework.com/docs/v3/cookbook/database-doctrine.html by HTTrack Website Copier/3.x [XR&CO'2014], Fri, 29 Nov 2019 20:20:20 GMT -->
</html>

